package test;

import sun.security.pkcs.PKCS7;
import sun.security.util.DerInputStream;

import java.security.cert.X509Certificate;
import java.util.Base64;

public class CheckPkcs7 {

    public static void main(String args[]) {
        String pkcs7Str = "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";

        Base64.Decoder base64Decoder = Base64.getDecoder();

        try {
            // 生成 PKCS7 物件。
            PKCS7 pkcs7 = new PKCS7(new DerInputStream(base64Decoder.decode(pkcs7Str.toString())));
            // 從 PKCS7 檔案中取出憑證。
            X509Certificate[] certs = pkcs7.getCertificates();
            // 驗證憑證有效性。
            X509Certificate prevCert = null;
            for(int i=0; i<certs.length; i++) {
                X509Certificate cert = certs[i];

                System.out.println("cert serialNumber >> " + cert.getSerialNumber());
                System.out.println("cert type >> " + cert.getType() );
                System.out.println("cert DN >> " + cert.getIssuerDN());
                System.out.println("cert DN >> "+ cert.getSubjectDN());
            }
        } catch (Exception ex) {
            System.out.println(ex.getLocalizedMessage() + ex);
        }
    }
}
